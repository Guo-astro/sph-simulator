--------------SPH simulation-------------

Loading plugin: lib/libshock_tube_plugin.dylib
Plugin loaded successfully
* Name:        shock_tube_enhanced
* Description: 1D Sod shock tube with type-safe parameter builder
* Version:     4.0.0
Open MP is valid.
the number of threads = 8

parameters
output directory     = output/shock_tube_enhanced
time
* start time         = 0
* end time           = 0
* output time        = 0
* energy output time = 0
SPH type: Standard SPH
CFL condition
* sound speed = 0
* force       = 0
Artificial Viscosity
* alpha = 0
Tree
* max tree level       = 0
* leaf particle number = 0
Physics
* Neighbor number = 0
* gamma           = 0
Kernel
* Cubic Spline
Simulation: shock_tube_enhanced
Description: 1D Sod shock tube with type-safe parameter builder
Version: 4.0.0
Initializing simulation from plugin: shock_tube_enhanced

=== ENHANCED SHOCK TUBE (Physics-Based Parameters) ===

--- Particle Initialization ---
Total particles: 450 (400 left + 50 right)
Left state:  ρ=1.0,    P=1.0,   dx=0.0025
Right state: ρ=0.125,  P=0.1,   dx=0.02 (Sod 1978)
Discontinuity at x=0.5
Uniform mass: m=0.0025
Initial sml estimates: left=0.003, right=0.024

--- Physics-Based Parameter Estimation ---

Estimated parameters from particle analysis:
  CFL_sound = 0.3 (from dt = CFL * h / (c_s + |v|))
  CFL_force = 0.25 (from dt = CFL * sqrt(h / |a|))
  neighbor_number = 6 (from kernel support volume)

Rationale:
Parameter suggestions from SPH stability analysis:

=== Particle Configuration ===
  Spacing: 0.0025
  Max sound speed: 1.18322
  Max acceleration: 0
  Dimension: 1D

=== CFL Coefficients (von Neumann Stability) ===
  CFL_sound = 0.3
    Formula: dt_sound = CFL_sound * h / (c_s + |v|)
    Physical meaning: wave doesn't propagate > h per timestep
    Literature: 0.25-0.4 (Monaghan 2005)

  CFL_force = 0.25
    Formula: dt_force = CFL_force * sqrt(h / |a|)
    Physical meaning: acceleration doesn't cause large displacement
    Literature: 0.125-0.25 (Monaghan 1989, Morris 1997)

=== Adjustments Applied ===

=== Neighbor Number ===
  neighbor_number = 6
  Calculated from kernel support volume in 1D
  Ensures smoothing length captures sufficient particles for accuracy


--- Building Parameter Set ---
✓ Parameters built with physics-based values

--- Parameter Validation ---
✓ All parameters validated - SAFE to run!

Expected timestep:
  dt_sound = 0.000633866
  dt_force = inf
  dt_actual = 0.000633866

--- Ghost Particle System ---
✓ Ghost particle system configured
  Boundary type: MIRROR (FREE_SLIP)
  Domain range: [-0.5, 1.5]
  (Ghost particles will be generated after sml calculation)

--- Configuration Summary ---
SPH Algorithm: Godunov SPH
CFL coefficients: sound=0.3, force=0.25
Neighbor number: 6
Gamma (adiabatic): 1.4
Kernel: Cubic Spline

=== Initialization Complete ===

Plugin initialization complete
write output/shock_tube_enhanced/00000.dat
write output/shock_tube_enhanced/00001.dat
write output/shock_tube_enhanced/00002.dat
write output/shock_tube_enhanced/00003.dat
write output/shock_tube_enhanced/00004.dat
write output/shock_tube_enhanced/00005.dat
write output/shock_tube_enhanced/00006.dat
write output/shock_tube_enhanced/00007.dat
write output/shock_tube_enhanced/00008.dat
loop: 355, time: 0.0802374, dt: 0.000204564, num: 450
write output/shock_tube_enhanced/00009.dat
write output/shock_tube_enhanced/00010.dat
write output/shock_tube_enhanced/00011.dat
write output/shock_tube_enhanced/00012.dat
write output/shock_tube_enhanced/00013.dat
write output/shock_tube_enhanced/00014.dat
loop: 694, time: 0.1479, dt: 0.000195619, num: 450
write output/shock_tube_enhanced/00015.dat

calculation is finished
calculation time: 2039 ms
